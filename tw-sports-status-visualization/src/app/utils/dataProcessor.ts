import { SportData } from './types';

// 示範資料（實際應用中會從API或檔案中獲取）
export const mockSportData: SportData[] = [
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '性別', 統計項目說明: '整體', 分析結果值: 31.3, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '性別', 統計項目說明: '男', 分析結果值: 35.6, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '性別', 統計項目說明: '女', 分析結果值: 27.0, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7330運動狀況', 統計項目: '性別', 統計項目說明: '整體', 分析結果值: 42.3, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7330運動狀況', 統計項目: '性別', 統計項目說明: '男', 分析結果值: 47.3, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7330運動狀況', 統計項目: '性別', 統計項目說明: '女', 分析結果值: 41.6, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7230運動狀況', 統計項目: '性別', 統計項目說明: '整體', 分析結果值: 56.6, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7230運動狀況', 統計項目: '性別', 統計項目說明: '男', 分析結果值: 60.4, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7230運動狀況', 統計項目: '性別', 統計項目說明: '女', 分析結果值: 53.5, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7100運動狀況', 統計項目: '性別', 統計項目說明: '整體', 分析結果值: 76.7, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7100運動狀況', 統計項目: '性別', 統計項目說明: '男', 分析結果值: 76.9, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7100運動狀況', 統計項目: '性別', 統計項目說明: '女', 分析結果值: 72.3, 分析結果單位: '百分比' },
  
  // 年齡數據
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '13-17歲', 分析結果值: 47.1, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '18-24歲', 分析結果值: 33.4, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '25-29歲', 分析結果值: 26.0, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '30-34歲', 分析結果值: 19.4, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '35-39歲', 分析結果值: 18.8, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '40-44歲', 分析結果值: 19.7, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '45-49歲', 分析結果值: 22.3, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '50-54歲', 分析結果值: 22.2, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '55-59歲', 分析結果值: 26.8, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '60-64歲', 分析結果值: 54.0, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '65-69歲', 分析結果值: 58.6, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '年齡', 統計項目說明: '70歲及以上', 分析結果值: 51.9, 分析結果單位: '百分比' },
  
  // 身體質量指數數據
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '身體質量指數', 統計項目說明: '過輕', 分析結果值: 32.80, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '身體質量指數', 統計項目說明: '標準', 分析結果值: 32.43, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '身體質量指數', 統計項目說明: '過重', 分析結果值: 31.51, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '身體質量指數', 統計項目說明: '肥胖', 分析結果值: 26.76, 分析結果單位: '百分比' },
  
  // 縣市數據
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '縣市', 統計項目說明: '新北市', 分析結果值: 25.56, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '縣市', 統計項目說明: '臺北市', 分析結果值: 24.56, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '縣市', 統計項目說明: '桃園市', 分析結果值: 23.85, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '縣市', 統計項目說明: '臺中市', 分析結果值: 24.68, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '縣市', 統計項目說明: '臺南市', 分析結果值: 24.47, 分析結果單位: '百分比' },
  { 統計年度: '102', 資料來源: '運動現況調查', 分析標的: '規律運動比例', 分析內容: '7333規律運動', 統計項目: '縣市', 統計項目說明: '高雄市', 分析結果值: 24.67, 分析結果單位: '百分比' },
];

// 獲取所有可用的分析標的
export const getAnalysisTargets = (data: SportData[]): string[] => {
  const targets = new Set<string>();
  data.forEach((item) => {
    targets.add(item.分析標的);
  });
  return Array.from(targets);
};

// 根據分析標的獲取相關的分析內容
export const getAnalysisContentsByTarget = (data: SportData[], target: string): string[] => {
  const contents = new Set<string>();
  data.forEach((item) => {
    if (item.分析標的 === target) {
      contents.add(item.分析內容);
    }
  });
  return Array.from(contents);
};

// 獲取時間序列圖表數據
export const getTimeSeriesData = (
  data: SportData[],
  analysisTarget: string,
  analysisContent: string,
  category: string = '性別'
) => {
  // 過濾出符合條件的數據
  const filteredData = data.filter(
    (item) => item.分析標的 === analysisTarget && 
              item.分析內容 === analysisContent && 
              item.統計項目 === category
  );
  
  // 如果沒有符合的數據，返回空圖表數據
  if (filteredData.length === 0) {
    return {
      labels: [],
      datasets: []
    };
  }
  
  // 獲取所有可用的年度
  const years = [...new Set(filteredData.map(item => item.統計年度))].sort();
  
  // 獲取所有可用的分類（如男/女/整體）
  const categories = [...new Set(filteredData.map(item => item.統計項目說明))];
  
  // 為每個分類創建一個數據集
  const datasets = categories.map(cat => {
    // 為該分類提取每個年度的數據
    const categoryData = years.map(year => {
      const dataPoint = filteredData.find(
        item => item.統計年度 === year && item.統計項目說明 === cat
      );
      return dataPoint ? dataPoint.分析結果值 : null;
    });
    
    // 生成固定顏色來區分不同分類
    let color = 'rgba(75, 192, 192, 1)';  // 默認顏色
    
    // 根據分類名稱分配顏色
    if (cat === '男') {
      color = 'rgba(54, 162, 235, 1)';  // 藍色系
    } else if (cat === '女') {
      color = 'rgba(255, 99, 132, 1)';  // 紅色系
    } else if (cat === '整體') {
      color = 'rgba(75, 192, 192, 1)';  // 綠色系
    }
    
    return {
      label: cat,
      data: categoryData,
      fill: false,
      borderColor: color,
      backgroundColor: color.replace('1)', '0.2)'),
      tension: 0.1
    };
  });
  
  return {
    labels: years,
    datasets
  };
};

// 獲取用於數據表的數據
export const getTimeSeriesTableData = (
  data: SportData[],
  analysisTarget: string,
  analysisContent: string,
  category: string = '性別'
) => {
  return data.filter(
    item => item.分析標的 === analysisTarget && 
            item.分析內容 === analysisContent &&
            item.統計項目 === category
  ).sort((a, b) => a.統計年度.localeCompare(b.統計年度));
}; 